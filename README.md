# KeyhacScripts

[@craftware](https://github.com/crftwr) 様の Keyhac 用スクリプトです。

Python のパッケージの仕組みを利用して、設定の追加・削除を簡単にしたり、  
ホットキーを簡単に設定する機能（関数）などを提供します。


## Keyhac とは

キーボード操作を柔軟に変更できるアプリケーションです。

[変換]キーが押されたら、IMEをONにする のような単純なキーの置換から、  
エクセル操作中は[F1]キーを無効にするなどのアプリケーション別の設定、  
特定のキーを押すだけで、キーボードマクロの実行や別アプリケーションの起動など  
幅広いことができます。

また、設定スクリプトを Python で記述できるため、  
Python の柔軟な文法と強力な機能を使うことができます。


## 導入手順

### 1. Keyhac の取得

下記公式サイト様より Keyhac をダウンロードして、任意の場所に展開してください。

- https://sites.google.com/site/craftware/keyhac-ja

### 2. スクリプトファイルの上書き

このレポジトリの内容を、1.で展開した Keyhac のディレクトリにコピーしてください。

ただし、config.py が上書きされますので、変更されている方は予めバックアップを行ってください。

## 構成

設定の追加変更が容易なように、スクリプトを分割して以下の構成で配置しています。

各モジュール内のファイル名の先頭に「_」をつけると読み込み対象外となります。

<pre>
/keyhac                   # Keyhac.exe のあるディレクトリ
├ /extention
| ├ hotkeys               # ホットキー設定スクリプト用ディレクトリ
| | ├ __init__.py         # パッケージ内モジュール初期化処理
| | ├ common.py           # アプリに依らない共通のホットキー
| | ├ common_win_grid.py  # ウインドウサイズ変更用ホットキー
| | ├ _skeleton.py        # ホットキー設定用の雛形
| |        ︙
| ├ lists                 # ヒストリー、リスト設定スクリプト用ディレクトリ
| | ├ __init__.py         # パッケージ内モジュール初期化処理
| | ├ _skeleton.py        # リスト設定用の雛形
| |        ︙
| ├ utils                 # 各種ユーティリティ用ディレクトリ
| | ├ key_util.py         # キー設定関連ユーティリティ
| | ├ ime_util.py         # IME関連ユーティリティ
| | ├ display_util.py     # ディスプレイ関連ユーティリティ
| |        ︙
| └ common.py             # 共通処理
├ config.py               # メインの設定ファイル（エントリポイント）
└ restart_keyhac.bat      # Keyhac再起動バッチ
</pre>
